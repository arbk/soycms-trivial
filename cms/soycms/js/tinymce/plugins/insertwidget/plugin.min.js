tinymce.PluginManager.add('insertwidget', function(editor) {
	function showDialog() {
		editor.windowManager.open({
			title: "ウィジェットを挿入",
			body: {
				name: 'code',
				type: 'textbox',
				label: 'ウィジェットのコード',
				autofocus: true,
				size: 40
			},
			onSubmit: function(e) {
				editor.execCommand('mceInsertContent', false, e.data.code);
			}
		});
	}

	editor.addCommand("mceCodeEditor", showDialog);

	editor.addButton('insertwidget', {
		icon: 'fullpage',
		tooltip: 'ウィジェットを挿入',
		onclick: showDialog
	});

	editor.addMenuItem('insertwidget', {
		icon: 'fullpage',
		text: 'ウィジェットを挿入',
		context: 'tools',
		onclick: showDialog
	});
});